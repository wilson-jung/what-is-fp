## 표현력 높이기

### go

---

```js
go(
  0,
  a => a + 1,
  a => a + 10,
  console.log)
```

```js
const reduce = (f, acc, iter) => {
  if (!iter) {
    iter = acc[Symbol.iterator]();
    acc = iter.next().value;
  }

  for (const n of iter) {
    acc = f(acc, n);
  }
  return acc;
};

const go = (...args) => reduce((a, f) => f(a), args);
```

### pipe: 함수를 리턴 하는 함수, 함수의 합성을 위한 함수

- go 와 다른점 go는 즉시 값을 평가하는데 사용함

---

```js
const pipe = (...fs) => (a) => go(a, ...fs);

const f = pipe(
  (a) => a + 1,
  (a) => a + 10,
  (a) => a + 100
);

console.log(f(0));
```

pipe 함수의 첫번째 인자 함수에 하나이상의 인자를 넣을 수 있다록 수정해보자

```js
const pipe = (f, ...fs) => (...a) => go(f(...a), ...fs);

const f = pipe(
  (a, b) => a + b,
  (a) => a + 10,
  (a) => a + 100
);

console.log(f(0, 1));
```

### curry

---

#### 사용법

```js
const multiply = curry((a, b) => a * b);
const multiply3 = multiply(3);
console.log(multiply3(2)); // 6
console.log(multiply(2, 3)); // 6
```

```js
const curry = (f) => (a, ...b) =>
  b.length ? f(a, ...b) : (...c) => f(a, ...c);
```

#### 기존 상품의 가격의 합을 go를 이용해 순서를 뒤집어 보자

```js
const products = [
  { name: "a", price: 1000 },
  { name: "b", price: 1100 },
  { name: "c", price: 1010 },
  { name: "d", price: 1001 },
];

const add = (a, b) => a + b;

// 기존 작성 된 flow
console.log(
  reduce(
    add,
    map(
      (p) => p.price,
      filter((p) => p.price < 1010, products)
    )
  )
);

// go 사용
go(
  products,
  (products) => filter((p) => p.price < 1010, products),
  (products) => map((p) => p.price, products),
  (prices) => reduce(add, prices),
  console.log
);
```

#### curry 를 사용해 go를 재작성해 보자

##### 우선 기존 함수를 curry를 이용하여 재작성 하자

```js
const map = curry((f, iter) => {
  let res = [];
  for (const a of iter) {
    res.push(f(a));
  }
  return res;
});

const filter = curry((f, iter) => {
  const res = [];
  for (const a of iter) {
    if (f(a)) res.push(a);
  }
  return res;
});

const reduce = curry((f, acc, iter) => {
  if (!iter) {
    iter = acc[Symbol.iterator]();
    acc = iter.next().value;
  }

  for (const n of iter) {
    acc = f(acc, n);
  }
  return acc;
});
```

##### 다시 go함수 사용을 보면

```js
go(
  products,
  ((products) => filter((p) => p.price < 1010))(products),
  (products) => map((p) => p.price)(products),
  (prices) => reduce(add)(prices),
  console.log
);
```
##### 더 정리해 보면
```js
go(
  products,
  filter((p) => p.price < 1010),
  map((p) => p.price),
  reduce(add),
  console.log
);
```
